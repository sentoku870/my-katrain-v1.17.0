# myKatrain（PC版）ロードマップ

> 最終更新: 2025-12-30
> 固定ルールは `00-purpose-and-scope.md` を参照。
> 作業履歴は `99-worklog.md` を参照。

---

## 0. 用語（短縮表記）

| 用語 | 説明 |
|------|------|
| カルテ（Karte） | 対局の要点・弱点・根拠をまとめた「診断用まとめ」 |
| アンカー | 根拠を追跡できる最小情報（手数/座標/損失/候補手） |
| LLMパッケージ | LLMに渡す一式（karte.md + sgf + coach.md） |

---

## 1. 完了済みフェーズ（Phase 1-4.5）

### Phase 1: 解析基盤の整備（2025-12-08 完了）
- `eval_metrics.py` 追加
- 手番視点の正規化、評価差・重要度スコア算出

### Phase 2: 解析ビュー第1段階（2025-12-09 完了）
- 重要局面ハイライト（グラフ上の縦線表示）
- YoseAnalyzer v1（簡易版）
- ナビゲーションボタン追加

### Phase 3: ミス分類＋局面難易度（完了）
- ミス分類（良/軽/悪/大悪）
- 手の自由度（広い/普通/狭い/一択）
- グラフ上に大悪手のオレンジライン表示

### Phase 4: 学習モード＋棋力別フィードバック（部分実装）
- Phase 4-1: クイズ候補抽出（2025-12-11 完了）
- Phase 4-2〜4-4: クイズモードUI（進行中）

### Phase 4.5: 評価指標の安定化（2025-12-29 完了）
- `MoveEval.is_reliable`（visitsベースの信頼性フラグ）導入
- 棋力別プリセット（beginner/standard/advanced）追加
- 重要手Top3の安定化
- i18n/CIの修正

---

## 2. これからのフェーズ一覧

| Phase | ゴール | 主成果物 | 状態 |
|------:|--------|----------|------|
| 5 | 1局カルテを安定出力 | `karte.md` + アンカー規則 | **次** |
| 6 | 複数局まとめで"悪癖"抽出 | `summary.md`（傾向） | TBD |
| 7 | LLMパッケージ生成 | `llm_package/` 一式 | TBD |
| 8 | 検証テンプレで改善ループ | `03-llm-validation.md` | TBD |
| 9+ | クイズ/コーチUIの拡張 | [TBD] | TBD |

---

## 3. Phase 5: 1局カルテ（最小）を安定出力

### 3.1 目的
「1局 = 1枚のカルテ」を **安定して再現** できる状態にする。

### 3.2 スコープ
**In:**
- 重要局面の抽出（最小）
- 弱点仮説（最小）
- 根拠アンカー（必須）
- 出力フォーマットの固定

**Out:**
- 自動送信（外部APIへの自動投稿）
- "人間らしさ調整"の深掘り
- クイズUIの作り込み

### 3.3 成果物
- [ ] `docs/02-karte-spec.md`（項目・アンカー規則）
- [ ] `export/karte.md`（または同等の出力）
- [ ] （任意）`export/karte.json`（機械可読版）

### 3.4 受け入れ条件
- [ ] 同じSGFでカルテの重要局面（ID/手数）が毎回ほぼ同じ
- [ ] カルテ内の主要指摘がアンカー情報だけで盤面再確認可能
- [ ] "改善行動"に落とせる粒度の仮説が1つ以上含まれる

### 3.5 テスト手順（手動）
1. テストSGF（3局）を用意
2. 毎回同じ操作でカルテを出力
3. 重要局面トップ3がブレすぎないか確認
4. 根拠が追えるか確認

---

## 4. Phase 6: 複数局まとめカルテ

### 4.1 目的
3-5局のカルテから、共通の負け筋/悪癖を **短い言葉** で抽出。

### 4.2 スコープ
**In:**
- 傾向の集計（読み負け/形勢判断/ヨセ/攻め合い等）
- 次の練習優先順位（1-3個）

**Out:**
- 個人最適化の高度な学習

### 4.3 成果物
- [ ] `export/summary.md`
- [ ] （任意）`export/habits.json`

### 4.4 受け入れ条件
- [ ] 3局の入力で、少なくとも1つの"繰り返し"が言語化される
- [ ] "やめる/やる"のルールが1-3個に絞られている

---

## 5. Phase 7: LLMパッケージ生成

### 5.1 目的
LLMに渡す資料を「迷わず添付できる一式」にする。

### 5.2 成果物
- [ ] `export/llm_package/karte.md`
- [ ] `export/llm_package/coach.md`
- [ ] `export/llm_package/game.sgf`
- [ ] `export/llm_package/prompt.md`（コピペ用）

### 5.3 受け入れ条件
- [ ] 添付だけで「追加質問→行動ルール」まで出せる
- [ ] 根拠追跡が崩れない

---

## 6. Phase 8: 検証テンプレで改善ループ

### 6.1 目的
検証手順を固定し、同条件で比較できるようにする。

### 6.2 成果物
- [ ] `docs/03-llm-validation.md`
- [ ] （任意）`export/validation_runs/`

### 6.3 受け入れ条件
- [ ] 1局カルテ→LLM→行動ルール→次局で試す、のサイクルが回る
- [ ] 成功条件が"測れる形"になる

---

## 7. Phase 9+（任意）: 拡張候補

- [ ] クイズUIの改善（表示の被り、操作性）
- [ ] コーチ画面（ルールカード、復習TODO）
- [ ] ヨセ/定石/攻め合い等の特化モジュール

---

## 8. "Done"の共通定義

- [ ] `00-purpose-and-scope.md` に矛盾しない
- [ ] 仕様の正本に反映されている
- [ ] 最小テスト手順があり、再現できる
- [ ] `99-worklog.md` に「何を変えたか/なぜ」を残す

---

## 9. 変更履歴

- 2025-12-30: Claude Code移行対応で整理、Phase 4.5完了を反映
- 2025-12-26: v0.1作成
